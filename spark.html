<!DOCTYPE html>
<html>
<head>
    <title>PySpark DataFrame Examples</title>
    <style>
        body { font-family: Arial, sans-serif; }
       pre { background-color: #f4f4f4; padding: 10px; overflow-x: auto;font-size: 16px; }

    </style>
</head>

    <p>&nbsp;</p>
<table style="border: none; border-collapse: collapse; width: 1069px;">
<tbody>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; text-align: center; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Loading table as Dataframe</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df = spark.table("default.movies")</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; text-align: center; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Viewing Data</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; text-align: center; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">Command</td>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; text-align: center; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">What It Does</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Displays the first <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">5 rows</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;of the DataFrame.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.printSchema()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Shows the <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">schema (column names &amp; data types)</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.columns</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Returns a <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">list of column names</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.describe().show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Provides <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">summary statistics</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;(count, mean, min, max) for numerical columns.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-image: initial; border-top: none; border-right: none; border-bottom: none; border-left: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">display(df)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-image: initial; border-top: none; border-right: 0.5pt solid windowtext; border-bottom: none; border-left: 0.5pt solid windowtext; width: 521.938px;">Use this to view the table as a SQL table, instead of broken line table.</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-image: initial; border-top: none; border-right: none; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;"><span style="color: black; font-size: 16px; font-weight: 400; font-style: italic; text-decoration: none; font-family: 'Arial Unicode MS';">example</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS';">: df.select("make", "model", "price").show(10)</span></td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-image: initial; border-top: none; border-right: 0.5pt solid windowtext; border-bottom: none; border-left: 0.5pt solid windowtext; width: 521.938px;">becomes: display(df.select("make", "model", "price").limit(10))</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border-image: initial; border-top: none; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; width: 521.938px;">NOTE: you must use limit when using display, and not show&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Row Counts &amp; Stucture</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.count()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Returns the <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">total number of rows</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;in the DataFrame.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.distinct().count()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Counts <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">distinct rows</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;in the DataFrame.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Selecting &amp; Filtering Data</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.select("Title", "Genre").show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Selects and displays <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">specific columns</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.filter(df.Rating &gt; 8.0).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Filters movies where <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Rating &gt; 8.0</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.where(df.ReleaseYear &gt; 2015).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Another way to <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">filter rows</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">, same as&nbsp;</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS';">.filter()</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Sorting &amp; Ordering</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.orderBy(df.Rating.desc()).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Sorts movies by <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">highest rating</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.orderBy(["ReleaseYear", "Rating"], ascending=[False, True]).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Sorts by <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">ReleaseYear (descending) and Rating (ascending)</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Grouping &amp; Aggregations</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.groupBy("Genre").count().show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Groups by <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Genre</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;and&nbsp;</span><span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">counts the number of movies</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.groupBy("Genre").avg("Rating").show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Finds the <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">average rating</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;per genre.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Adding Dropping Columns</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.withColumn("RevenueBillions", df.RevenueMillions / 1000).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Adds a new column <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">RevenueBillions</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.drop("RevenueBillions").show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Removes the <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">RevenueBillions</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;column.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Handling Missing Data</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.na.drop().show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Removes <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">rows with NULL values</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.na.fill(0).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Fills NULL values with <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">0</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.fillna("Unknown", subset=["Title"]).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Fills NULLs in <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Title column</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;with&nbsp;</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS';">"Unknown"</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Complex Filtering &amp; Conditions</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.filter((df.Genre == "Action") &amp; (df.Rating &gt; 8.0)).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Filters <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Action movies</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;with&nbsp;</span><span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Rating &gt; 8.0</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.filter(df.Title.contains("Avengers")).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Finds <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">movies with "Avengers" in the title</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.filter(df.Genre.isin(["Action", "Sci-Fi"])).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Filters movies where <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Genre is Action or Sci-Fi</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Advanced Aggregations</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.groupBy("Genre").agg({"RevenueMillions": "sum"}).show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Finds <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">total revenue per Genre</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 13px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.groupBy("ReleaseYear").agg({"Rating": "avg", "RevenueMillions": "sum"}).show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Computes <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">average rating &amp; total revenue per year</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Joining &amp; Merging Dataframes</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df_movies.join(df_directors, "MovieID").show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Joins two DataFrames on <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">MovieID</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 13px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 26.4pt; border-top: none; width: 542.588px;">df_movies.alias("m").join(df_directors.alias("d"), df_movies.MovieID == df_directors.MovieID).select("m.Title", "d.DirectorName").show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Joins with aliases for better readability.</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Using SQL Queries</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.createOrReplaceTempView("movies")</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Creates a <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">temporary SQL table</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;from the DataFrame.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 13px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">spark.sql("SELECT Genre, AVG(Rating) FROM movies GROUP BY Genre").show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Runs an <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">SQL query</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;on the DataFram</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Windows Functions</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">from pyspark.sql.window import Window</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Imports <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Window functions</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;(used for ranking, running totals, etc.).</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">windowSpec = Window.partitionBy("Genre").orderBy(df.Rating.desc())</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Defines a <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">window partitioned by Genre</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;and&nbsp;</span><span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">ordered by Rating</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.withColumn("Rank", rank().over(windowSpec)).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Assigns a <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">ranking</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;to movies within each&nbsp;</span><span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Genre</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Pivoting &amp; Reshaping Data</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.groupBy("Genre").pivot("ReleaseYear").sum("RevenueMillions").show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Pivots data to show <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">total revenue per year per genre</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Writing Data to Storage</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.write.format("parquet").save("/mnt/movies_parquet")</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Saves DataFrame as <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Parquet format</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.write.format("delta").mode("overwrite").saveAsTable("movies_delta")</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Saves as a <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Delta Table</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;for ACID transactions.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Check Table Format</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">DESCRIBE FORMATTED consoles;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Checks type table - delta, parquet, csv etc</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">Describe detail consoles;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">information about table - including if delta,parquet,csv etc.</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Creating your own structured scheme</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">use structype to create</td>
<td style="color: black; font-size: 12px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">from pyspark.sql.types import StructType, StructField, StringType, BooleanType, DoubleType, LongType</td>
</tr>
</tbody>
</table>
    
<body>
    <h1>PySpark Basics - Databricks</h1>
    
    <h2>Creating a Spark Session</h2>
    <pre>
from pyspark.sql import SparkSession

# Create Spark session
spark = SparkSession.builder.appName("Databricks PySpark Guide").getOrCreate()
    </pre>
    
    <h2>Creating DataFrames</h2>
    <pre>
from pyspark.sql import Row

# Creating a DataFrame manually
data = [Row(id=1, name='Alice', amount=100.50), Row(id=2, name='Bob', amount=200.75)]
df = spark.createDataFrame(data)
df.show()
    </pre>
    
    <h2>Reading Delta Tables</h2>
    <pre>
# Read a Delta table into a DataFrame
df = spark.read.format("delta").table("sales")
df.show()
    </pre>
    
    <h2>Transforming DataFrames</h2>
    <pre>
from pyspark.sql.functions import col

# Filter and select specific columns
df_filtered = df.filter(col("amount") > 100).select("name", "amount")
df_filtered.show()
    </pre>
    
    <h2>Writing DataFrames to Delta Tables</h2>
    <pre>
# Write a DataFrame to a Delta table
df.write.format("delta").mode("append").saveAsTable("sales")
    </pre>
    
    <h2>Updating Delta Tables</h2>
    <pre>
from delta.tables import DeltaTable

delta_table = DeltaTable.forName(spark, "sales")
delta_table.update(
    condition=col("id") == 1,
    set={"amount": col("amount") * 1.1}  # Increase amount by 10%
)
    </pre>
    
    <h2>Deleting Data from Delta Tables</h2>
    <pre>
# Delete records from Delta table
delta_table.delete(col("id") == 2)
    </pre>
    
    <h2>Optimizing Delta Tables</h2>
    <pre>
# Optimize Delta table to improve query performance
spark.sql("OPTIMIZE sales ZORDER BY order_date")
    </pre>
    
    <h1>Beginner PySpark DataFrame Examples</h1>
    
    <h2>Creating a Simple DataFrame</h2>
    <pre>
data = [("Alice", 25), ("Bob", 30), ("Charlie", 35)]
columns = ["Name", "Age"]
df = spark.createDataFrame(data, columns)
df.show()
    </pre>
    
    <h2>Creating a DataFrame from JSON</h2>
    <pre>
data = [{"Name": "Alice", "Age": 25}, {"Name": "Bob", "Age": 30}]
df = spark.read.json(spark.sparkContext.parallelize(data))
df.show()
    </pre>
    
    <h2>Selecting Specific Columns</h2>
    <pre>
df.select("Name").show()
    </pre>
    
    <h2>Filtering Data</h2>
    <pre>
df.filter(df.Age > 28).show()
    </pre>
    
    <h2>Adding a New Column</h2>
    <pre>
df = df.withColumn("Salary", df.Age * 1000)
df.show()
    </pre>
    
    <h2>Sorting Data</h2>
    <pre>
df.orderBy(df.Age.desc()).show()
    </pre>
    
    <h2>Counting Rows</h2>
    <pre>
df.count()
    </pre>
    
    <h2>Aggregations (Find Average Age)</h2>
    <pre>
from pyspark.sql.functions import avg
df.select(avg("Age")).show()
    </pre>
    
    <h2>Grouping Data</h2>
    <pre>
df.groupBy("Age").count().show()
    </pre>
    
    <h2>Saving DataFrame as a Table (Delta Table)</h2>
    <pre>
df.write.format("delta").mode("overwrite").saveAsTable("people_table")
    </pre>
    
    <h1>Intermediate PySpark DataFrame Examples</h1>
    
    <h2>Reading a Delta Table</h2>
    <pre>
df_delta = spark.read.table("people_table")
df_delta.show()
    </pre>
    
    <h2>Updating a Delta Table</h2>
    <pre>
delta_table = DeltaTable.forName(spark, "people_table")
delta_table.update(
    condition="Name = 'Alice'",
    set={"Age": "Age + 1"}
)
    </pre>
    
    <h2>Deleting Data from a Delta Table</h2>
    <pre>
delta_table.delete("Age < 30")
    </pre>
    
    <h2>Time Travel (View Old Data Version)</h2>
    <pre>
df_old = spark.read.format("delta").option("versionAsOf", 0).table("people_table")
df_old.show()
    </pre>
</body>
</html>

