<p>&nbsp;</p>
<table style="border: none; border-collapse: collapse; width: 1069px;">
<tbody>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; text-align: center; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Loading table as Dataframe</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df = spark.table("default.movies")</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; text-align: center; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Viewing Data</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; text-align: center; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">Command</td>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; text-align: center; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">What It Does</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Displays the first <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">5 rows</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;of the DataFrame.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.printSchema()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Shows the <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">schema (column names &amp; data types)</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.columns</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Returns a <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">list of column names</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.describe().show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Provides <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">summary statistics</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;(count, mean, min, max) for numerical columns.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-image: initial; border-top: none; border-right: none; border-bottom: none; border-left: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">display(df)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-image: initial; border-top: none; border-right: 0.5pt solid windowtext; border-bottom: none; border-left: 0.5pt solid windowtext; width: 521.938px;">Use this to view the table as a SQL table, instead of broken line table.</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-image: initial; border-top: none; border-right: none; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;"><span style="color: black; font-size: 16px; font-weight: 400; font-style: italic; text-decoration: none; font-family: 'Arial Unicode MS';">example</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS';">: df.select("make", "model", "price").show(10)</span></td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-image: initial; border-top: none; border-right: 0.5pt solid windowtext; border-bottom: none; border-left: 0.5pt solid windowtext; width: 521.938px;">becomes: display(df.select("make", "model", "price").limit(10))</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border-image: initial; border-top: none; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; width: 521.938px;">NOTE: you must use limit when using display, and not show&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Row Counts &amp; Stucture</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.count()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Returns the <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">total number of rows</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;in the DataFrame.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.distinct().count()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Counts <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">distinct rows</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;in the DataFrame.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Selecting &amp; Filtering Data</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.select("Title", "Genre").show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Selects and displays <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">specific columns</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.filter(df.Rating &gt; 8.0).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Filters movies where <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Rating &gt; 8.0</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.where(df.ReleaseYear &gt; 2015).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Another way to <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">filter rows</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">, same as&nbsp;</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS';">.filter()</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Sorting &amp; Ordering</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.orderBy(df.Rating.desc()).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Sorts movies by <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">highest rating</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.orderBy(["ReleaseYear", "Rating"], ascending=[False, True]).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Sorts by <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">ReleaseYear (descending) and Rating (ascending)</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Grouping &amp; Aggregations</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.groupBy("Genre").count().show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Groups by <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Genre</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;and&nbsp;</span><span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">counts the number of movies</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.groupBy("Genre").avg("Rating").show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Finds the <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">average rating</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;per genre.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Adding Dropping Columns</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.withColumn("RevenueBillions", df.RevenueMillions / 1000).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Adds a new column <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">RevenueBillions</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.drop("RevenueBillions").show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Removes the <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">RevenueBillions</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;column.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Handling Missing Data</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.na.drop().show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Removes <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">rows with NULL values</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.na.fill(0).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Fills NULL values with <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">0</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.fillna("Unknown", subset=["Title"]).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Fills NULLs in <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Title column</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;with&nbsp;</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS';">"Unknown"</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Complex Filtering &amp; Conditions</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.filter((df.Genre == "Action") &amp; (df.Rating &gt; 8.0)).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Filters <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Action movies</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;with&nbsp;</span><span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Rating &gt; 8.0</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.filter(df.Title.contains("Avengers")).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Finds <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">movies with "Avengers" in the title</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.filter(df.Genre.isin(["Action", "Sci-Fi"])).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Filters movies where <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Genre is Action or Sci-Fi</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Advanced Aggregations</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.groupBy("Genre").agg({"RevenueMillions": "sum"}).show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Finds <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">total revenue per Genre</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 13px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.groupBy("ReleaseYear").agg({"Rating": "avg", "RevenueMillions": "sum"}).show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Computes <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">average rating &amp; total revenue per year</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Joining &amp; Merging Dataframes</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df_movies.join(df_directors, "MovieID").show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Joins two DataFrames on <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">MovieID</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 13px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 26.4pt; border-top: none; width: 542.588px;">df_movies.alias("m").join(df_directors.alias("d"), df_movies.MovieID == df_directors.MovieID).select("m.Title", "d.DirectorName").show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Joins with aliases for better readability.</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Using SQL Queries</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.createOrReplaceTempView("movies")</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Creates a <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">temporary SQL table</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;from the DataFrame.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 13px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">spark.sql("SELECT Genre, AVG(Rating) FROM movies GROUP BY Genre").show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Runs an <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">SQL query</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;on the DataFram</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Windows Functions</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">from pyspark.sql.window import Window</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Imports <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Window functions</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;(used for ranking, running totals, etc.).</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">windowSpec = Window.partitionBy("Genre").orderBy(df.Rating.desc())</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Defines a <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">window partitioned by Genre</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;and&nbsp;</span><span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">ordered by Rating</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.withColumn("Rank", rank().over(windowSpec)).show(5)</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Assigns a <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">ranking</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;to movies within each&nbsp;</span><span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Genre</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Pivoting &amp; Reshaping Data</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.groupBy("Genre").pivot("ReleaseYear").sum("RevenueMillions").show()</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Pivots data to show <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">total revenue per year per genre</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Writing Data to Storage</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">df.write.format("parquet").save("/mnt/movies_parquet")</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Saves DataFrame as <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Parquet format</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Arial Unicode MS'; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">df.write.format("delta").mode("overwrite").saveAsTable("movies_delta")</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: middle; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">Saves as a <span style="color: black; font-size: 16px; font-weight: bold; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">Delta Table</span><span style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif;">&nbsp;for ACID transactions.</span></td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Check Table Format</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">DESCRIBE FORMATTED consoles;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">Checks type table - delta, parquet, csv etc</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-left: 0.5pt solid windowtext; border-image: initial; height: 15.6pt; border-top: none; width: 542.588px;">Describe detail consoles;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-top: none; border-left: none; width: 521.938px;">information about table - including if delta,parquet,csv etc.</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; height: 15.6pt; width: 542.588px;">&nbsp;</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: bold; font-style: italic; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; background: #f1a983; height: 15.6pt; width: 542.588px;">Creating your own structured scheme</td>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: none; width: 521.938px;">&nbsp;</td>
</tr>
<tr>
<td style="color: black; font-size: 16px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border: 0.5pt solid windowtext; height: 15.6pt; width: 542.588px;">use structype to create</td>
<td style="color: black; font-size: 12px; font-weight: 400; font-style: normal; text-decoration: none; font-family: 'Aptos Narrow', sans-serif; vertical-align: bottom; border-top: 0.5pt solid windowtext; border-right: 0.5pt solid windowtext; border-bottom: 0.5pt solid windowtext; border-image: initial; border-left: none; width: 521.938px;">from pyspark.sql.types import StructType, StructField, StringType, BooleanType, DoubleType, LongType</td>
</tr>
</tbody>
</table>

<h2><strong>1. Data Ingestion &amp; Reading Files</strong></h2>
<p><strong>Reading a CSV File</strong><br>Loads a CSV file into a DataFrame with headers and inferred schema.</p>
<pre><div><div><div>
</div></div><div><code><span style="font-size: 16px;">from pyspark.sql import SparkSession

spark = SparkSession.builder.appName(&quot;ReadCSV&quot;).getOrCreate()

df = spark.read.format(&quot;csv&quot;) \
    .option(&quot;header&quot;, &quot;true&quot;) \
    .option(&quot;inferSchema&quot;, &quot;true&quot;) \
    .load(&quot;/mnt/data/sample.csv&quot;)

df.show()
</span></code></div></div></pre>
<hr>
<p><strong>Reading a Parquet File</strong><br>Reads a Parquet file from Databricks storage.</p>
<pre><div><div><div><span style="font-size: 16px;">
</span></div></div><div><span style="font-size: 16px;"><code>df = spark.read.parquet(&quot;/mnt/data/sample.parquet&quot;)
df.show()
</code></span></div></div></pre>
<hr>
<p><strong>Reading a Delta Table</strong><br>Loads a Delta Table with schema enforcement and ACID support.</p>
<pre><div><div><div>
</div></div><div><code><span style="font-size: 16px;">delta_df = spark.read.format(&quot;delta&quot;).load(&quot;/mnt/delta/sample_table&quot;)
delta_df.show()</span>
</code></div></div></pre>
<hr>
<h2><strong>2. Data Transformations</strong></h2>
<p><strong>Selecting and Filtering Data</strong><br>Selects specific columns and filters rows where the amount is greater than 1000.</p>
<pre><div><div><div><span style="font-size: 16px;">
</span></div></div><div><code><span style="font-size: 16px;">filtered_df = df.select(&quot;customer_id&quot;, &quot;order_date&quot;, &quot;amount&quot;).filter(df.amount &gt; 1000)
filtered_df.show()</span>
</code></div></div></pre>
<hr>
<p><strong>Using SQL Queries in PySpark</strong><br>Runs SQL directly on a temporary view for aggregation.</p>
<pre><div><div><div>
</div></div><div><code><span style="font-size: 16px;">df.createOrReplaceTempView(&quot;sales_data&quot;)

sql_df = spark.sql(&quot;&quot;&quot;
    SELECT customer_id, SUM(amount) AS total_spent
    FROM sales_data
    GROUP BY customer_id
&quot;&quot;&quot;)
sql_df.show()
</span></code></div></div></pre>
<hr>
<p><strong>Joining Two DataFrames</strong><br>Performs an inner join and selects columns from both tables.</p>
<pre><div><div><div>
</div></div><div><code><span style="font-size: 16px;">df1.join(df2, df1.id == df2.id, &quot;inner&quot;) \
   .select(df1.name, df2.salary) \
   .show()
</span></code></div></div></pre>
<hr>
<h2><strong>3. Aggregations &amp; Window Functions</strong></h2>
<p><strong>Aggregating Data</strong><br>Groups by category and calculates total and average sales.</p>
<pre><div><div><div>
</div></div><div><code><span style="font-size: 16px;">from pyspark.sql.functions import sum, avg

df.groupBy(&quot;category&quot;) \
  .agg(sum(&quot;sales&quot;).alias(&quot;total_sales&quot;), avg(&quot;sales&quot;).alias(&quot;avg_sales&quot;)) \
  .show()</span>
</code></div></div></pre>
<hr>
<p><strong>Using Window Functions</strong><br>Assigns row numbers within each category sorted by sales.</p>
<pre><div><div><div>
</div></div><div><code><span style="font-size: 16px;">from pyspark.sql.window import Window
from pyspark.sql.functions import row_number

window_spec = Window.partitionBy(&quot;category&quot;).orderBy(&quot;sales&quot;)

df.withColumn(&quot;row_num&quot;, row_number().over(window_spec)).show()</span>
</code></div></div></pre>
<hr>
<h2><strong>4. Writing Data</strong></h2>
<p><strong>Saving as a Delta Table</strong><br>Writes the DataFrame to a Delta format.</p>
<pre><div><div><div>
</div></div><div><code><span style="font-size: 16px;">df.write.format(&quot;delta&quot;).mode(&quot;overwrite&quot;).save(&quot;/mnt/delta/sales_table&quot;)</span>
</code></div></div></pre>
<hr>
<p><strong>Writing to Parquet</strong><br>Stores the DataFrame in Parquet format.</p>
<pre><div><div><div>
</div></div><div><code><span style="font-size: 16px;">df.write.parquet(&quot;/mnt/data/sales_data.parquet&quot;, mode=&quot;overwrite&quot;)</span>
</code></div></div></pre>
<hr>
<p><strong>Writing as a Table in Databricks</strong><br>Saves the DataFrame as a managed table.</p>
<pre><div><div><div>
</div></div><div><code><span style="font-size: 16px;">df.write.mode(&quot;overwrite&quot;).saveAsTable(&quot;sales_data&quot;)
</span></code></div></div></pre>
<hr>
<h2><strong>5. Streaming Data Processing</strong></h2>
<p><strong>Reading a Kafka Stream</strong><br>Consumes real-time Kafka messages and prints them to the console.</p>
<pre><div><div><div>
</div></div><div><code><span style="font-size: 16px;">kafka_df = spark.readStream.format(&quot;kafka&quot;) \
    .option(&quot;kafka.bootstrap.servers&quot;, &quot;host:port&quot;) \
    .option(&quot;subscribe&quot;, &quot;topic&quot;) \
    .load()

kafka_df.selectExpr(&quot;CAST(value AS STRING)&quot;) \
    .writeStream.format(&quot;console&quot;) \
    .start()
</span></code></div></div></pre>
<hr>
<p><strong>Writing Streaming Data to a Delta Table</strong><br>Streams data into Delta Table with checkpointing.</p>
<pre><div><div><div>
</div></div><div><code>df.writeStream.format(&quot;delta&quot;) \
  .option(&quot;checkpointLocation&quot;, &quot;/mnt/checkpoints/&quot;) \
  .start(&quot;/mnt/delta/streaming_table&quot;)
</code></div></div></pre>
<hr>
<h2><strong>6. Performance Optimization</strong></h2>
<p><strong>Using Cache</strong><br>Caches the DataFrame in memory for faster repeated access.</p>
<pre><div><div>python</div><div><div><div><button><svg width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.668 10.667C12.668 9.95614 12.668 9.46258 12.6367 9.0791C12.6137 8.79732 12.5758 8.60761 12.5244 8.46387L12.4688 8.33399C12.3148 8.03193 12.0803 7.77885 11.793 7.60254L11.666 7.53125C11.508 7.45087 11.2963 7.39395 10.9209 7.36328C10.5374 7.33197 10.0439 7.33203 9.33301 7.33203H6.5C5.78896 7.33203 5.29563 7.33195 4.91211 7.36328C4.63016 7.38632 4.44065 7.42413 4.29688 7.47559L4.16699 7.53125C3.86488 7.68518 3.61186 7.9196 3.43555 8.20703L3.36524 8.33399C3.28478 8.49198 3.22795 8.70352 3.19727 9.0791C3.16595 9.46259 3.16504 9.95611 3.16504 10.667V13.5C3.16504 14.211 3.16593 14.7044 3.19727 15.0879C3.22797 15.4636 3.28473 15.675 3.36524 15.833L3.43555 15.959C3.61186 16.2466 3.86474 16.4807 4.16699 16.6348L4.29688 16.6914C4.44063 16.7428 4.63025 16.7797 4.91211 16.8027C5.29563 16.8341 5.78896 16.835 6.5 16.835H9.33301C10.0439 16.835 10.5374 16.8341 10.9209 16.8027C11.2965 16.772 11.508 16.7152 11.666 16.6348L11.793 16.5645C12.0804 16.3881 12.3148 16.1351 12.4688 15.833L12.5244 15.7031C12.5759 15.5594 12.6137 15.3698 12.6367 15.0879C12.6681 14.7044 12.668 14.211 12.668 13.5V10.667ZM13.998 12.665C14.4528 12.6634 14.8011 12.6602 15.0879 12.6367C15.4635 12.606 15.675 12.5492 15.833 12.4688L15.959 12.3975C16.2466 12.2211 16.4808 11.9682 16.6348 11.666L16.6914 11.5361C16.7428 11.3924 16.7797 11.2026 16.8027 10.9209C16.8341 10.5374 16.835 10.0439 16.835 9.33301V6.5C16.835 5.78896 16.8341 5.29563 16.8027 4.91211C16.7797 4.63025 16.7428 4.44063 16.6914 4.29688L16.6348 4.16699C16.4807 3.86474 16.2466 3.61186 15.959 3.43555L15.833 3.36524C15.675 3.28473 15.4636 3.22797 15.0879 3.19727C14.7044 3.16593 14.211 3.16504 13.5 3.16504H10.667C9.9561 3.16504 9.46259 3.16595 9.0791 3.19727C8.79739 3.22028 8.6076 3.2572 8.46387 3.30859L8.33399 3.36524C8.03176 3.51923 7.77886 3.75343 7.60254 4.04102L7.53125 4.16699C7.4508 4.32498 7.39397 4.53655 7.36328 4.91211C7.33985 5.19893 7.33562 5.54719 7.33399 6.00195H9.33301C10.022 6.00195 10.5791 6.00131 11.0293 6.03809C11.4873 6.07551 11.8937 6.15471 12.2705 6.34668L12.4883 6.46875C12.984 6.7728 13.3878 7.20854 13.6533 7.72949L13.7197 7.87207C13.8642 8.20859 13.9292 8.56974 13.9619 8.9707C13.9987 9.42092 13.998 9.97799 13.998 10.667V12.665ZM18.165 9.33301C18.165 10.022 18.1657 10.5791 18.1289 11.0293C18.0961 11.4302 18.0311 11.7914 17.8867 12.1279L17.8203 12.2705C17.5549 12.7914 17.1509 13.2272 16.6553 13.5313L16.4365 13.6533C16.0599 13.8452 15.6541 13.9245 15.1963 13.9619C14.8593 13.9895 14.4624 13.9935 13.9951 13.9951C13.9935 14.4624 13.9895 14.8593 13.9619 15.1963C13.9292 15.597 13.864 15.9576 13.7197 16.2939L13.6533 16.4365C13.3878 16.9576 12.9841 17.3941 12.4883 17.6982L12.2705 17.8203C11.8937 18.0123 11.4873 18.0915 11.0293 18.1289C10.5791 18.1657 10.022 18.165 9.33301 18.165H6.5C5.81091 18.165 5.25395 18.1657 4.80371 18.1289C4.40306 18.0962 4.04235 18.031 3.70606 17.8867L3.56348 17.8203C3.04244 17.5548 2.60585 17.151 2.30176 16.6553L2.17969 16.4365C1.98788 16.0599 1.90851 15.6541 1.87109 15.1963C1.83431 14.746 1.83496 14.1891 1.83496 13.5V10.667C1.83496 9.978 1.83432 9.42091 1.87109 8.9707C1.90851 8.5127 1.98772 8.10625 2.17969 7.72949L2.30176 7.51172C2.60586 7.0159 3.04236 6.6122 3.56348 6.34668L3.70606 6.28027C4.04237 6.136 4.40303 6.07083 4.80371 6.03809C5.14051 6.01057 5.53708 6.00551 6.00391 6.00391C6.00551 5.53708 6.01057 5.14051 6.03809 4.80371C6.0755 4.34588 6.15483 3.94012 6.34668 3.56348L6.46875 3.34473C6.77282 2.84912 7.20856 2.44514 7.72949 2.17969L7.87207 2.11328C8.20855 1.96886 8.56979 1.90385 8.9707 1.87109C9.42091 1.83432 9.978 1.83496 10.667 1.83496H13.5C14.1891 1.83496 14.746 1.83431 15.1963 1.87109C15.6541 1.90851 16.0599 1.98788 16.4365 2.17969L16.6553 2.30176C17.151 2.60585 17.5548 3.04244 17.8203 3.56348L17.8867 3.70606C18.031 4.04235 18.0962 4.40306 18.1289 4.80371C18.1657 5.25395 18.165 5.81091 18.165 6.5V9.33301Z"></path></svg>Copy</button><button><svg width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.0303 4.11328C13.4406 2.70317 15.7275 2.70305 17.1377 4.11328C18.5474 5.52355 18.5476 7.81057 17.1377 9.2207L10.8457 15.5117C10.522 15.8354 10.2868 16.0723 10.0547 16.2627L9.82031 16.4395C9.61539 16.5794 9.39783 16.7003 9.1709 16.7998L8.94141 16.8916C8.75976 16.9582 8.57206 17.0072 8.35547 17.0518L7.59082 17.1865L5.19727 17.5859C5.05455 17.6097 4.90286 17.6358 4.77441 17.6455C4.67576 17.653 4.54196 17.6555 4.39648 17.6201L4.24707 17.5703C4.02415 17.4746 3.84119 17.3068 3.72559 17.0957L3.67969 17.0029C3.59322 16.8013 3.59553 16.6073 3.60547 16.4756C3.61519 16.3473 3.6403 16.1963 3.66406 16.0537L4.06348 13.6602C4.1638 13.0582 4.22517 12.6732 4.3584 12.3096L4.45117 12.0791C4.55073 11.8521 4.67152 11.6346 4.81152 11.4297L4.9873 11.1953C5.17772 10.9632 5.4146 10.728 5.73828 10.4043L12.0303 4.11328ZM6.67871 11.3447C6.32926 11.6942 6.14542 11.8803 6.01953 12.0332L5.90918 12.1797C5.81574 12.3165 5.73539 12.4618 5.66895 12.6133L5.60742 12.7666C5.52668 12.9869 5.48332 13.229 5.375 13.8789L4.97656 16.2725L4.97559 16.2744H4.97852L7.37207 15.875L8.08887 15.749C8.25765 15.7147 8.37336 15.6839 8.4834 15.6436L8.63672 15.5811C8.78817 15.5146 8.93356 15.4342 9.07031 15.3408L9.2168 15.2305C9.36965 15.1046 9.55583 14.9207 9.90527 14.5713L14.8926 9.58301L11.666 6.35742L6.67871 11.3447ZM16.1963 5.05371C15.3054 4.16304 13.8616 4.16305 12.9707 5.05371L12.6074 5.41602L15.833 8.64258L16.1963 8.2793C17.0869 7.38845 17.0869 5.94456 16.1963 5.05371Z"></path><path d="M4.58301 1.7832C4.72589 1.7832 4.84877 1.88437 4.87695 2.02441C4.99384 2.60873 5.22432 3.11642 5.58398 3.50391C5.94115 3.88854 6.44253 4.172 7.13281 4.28711C7.27713 4.3114 7.38267 4.43665 7.38281 4.58301C7.38281 4.7295 7.27723 4.8546 7.13281 4.87891C6.44249 4.99401 5.94116 5.27746 5.58398 5.66211C5.26908 6.00126 5.05404 6.43267 4.92676 6.92676L4.87695 7.1416C4.84891 7.28183 4.72601 7.38281 4.58301 7.38281C4.44013 7.38267 4.31709 7.28173 4.28906 7.1416C4.17212 6.55728 3.94179 6.04956 3.58203 5.66211C3.22483 5.27757 2.72347 4.99395 2.0332 4.87891C1.88897 4.85446 1.7832 4.72938 1.7832 4.58301C1.78335 4.43673 1.88902 4.3115 2.0332 4.28711C2.72366 4.17203 3.22481 3.88861 3.58203 3.50391C3.94186 3.11638 4.17214 2.60888 4.28906 2.02441L4.30371 1.97363C4.34801 1.86052 4.45804 1.78333 4.58301 1.7832Z"></path></svg>Edit</button></div></div></div><div><code>df.cache()
df.count()  # Triggers the caching
</code></div></div></pre>
<hr>
<p><strong>Z-Ordering for Faster Queries</strong><br>Reorganizes the Delta table data for optimized reads.</p>
<pre><div><div>python</div><div><div><div><button><svg width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.668 10.667C12.668 9.95614 12.668 9.46258 12.6367 9.0791C12.6137 8.79732 12.5758 8.60761 12.5244 8.46387L12.4688 8.33399C12.3148 8.03193 12.0803 7.77885 11.793 7.60254L11.666 7.53125C11.508 7.45087 11.2963 7.39395 10.9209 7.36328C10.5374 7.33197 10.0439 7.33203 9.33301 7.33203H6.5C5.78896 7.33203 5.29563 7.33195 4.91211 7.36328C4.63016 7.38632 4.44065 7.42413 4.29688 7.47559L4.16699 7.53125C3.86488 7.68518 3.61186 7.9196 3.43555 8.20703L3.36524 8.33399C3.28478 8.49198 3.22795 8.70352 3.19727 9.0791C3.16595 9.46259 3.16504 9.95611 3.16504 10.667V13.5C3.16504 14.211 3.16593 14.7044 3.19727 15.0879C3.22797 15.4636 3.28473 15.675 3.36524 15.833L3.43555 15.959C3.61186 16.2466 3.86474 16.4807 4.16699 16.6348L4.29688 16.6914C4.44063 16.7428 4.63025 16.7797 4.91211 16.8027C5.29563 16.8341 5.78896 16.835 6.5 16.835H9.33301C10.0439 16.835 10.5374 16.8341 10.9209 16.8027C11.2965 16.772 11.508 16.7152 11.666 16.6348L11.793 16.5645C12.0804 16.3881 12.3148 16.1351 12.4688 15.833L12.5244 15.7031C12.5759 15.5594 12.6137 15.3698 12.6367 15.0879C12.6681 14.7044 12.668 14.211 12.668 13.5V10.667ZM13.998 12.665C14.4528 12.6634 14.8011 12.6602 15.0879 12.6367C15.4635 12.606 15.675 12.5492 15.833 12.4688L15.959 12.3975C16.2466 12.2211 16.4808 11.9682 16.6348 11.666L16.6914 11.5361C16.7428 11.3924 16.7797 11.2026 16.8027 10.9209C16.8341 10.5374 16.835 10.0439 16.835 9.33301V6.5C16.835 5.78896 16.8341 5.29563 16.8027 4.91211C16.7797 4.63025 16.7428 4.44063 16.6914 4.29688L16.6348 4.16699C16.4807 3.86474 16.2466 3.61186 15.959 3.43555L15.833 3.36524C15.675 3.28473 15.4636 3.22797 15.0879 3.19727C14.7044 3.16593 14.211 3.16504 13.5 3.16504H10.667C9.9561 3.16504 9.46259 3.16595 9.0791 3.19727C8.79739 3.22028 8.6076 3.2572 8.46387 3.30859L8.33399 3.36524C8.03176 3.51923 7.77886 3.75343 7.60254 4.04102L7.53125 4.16699C7.4508 4.32498 7.39397 4.53655 7.36328 4.91211C7.33985 5.19893 7.33562 5.54719 7.33399 6.00195H9.33301C10.022 6.00195 10.5791 6.00131 11.0293 6.03809C11.4873 6.07551 11.8937 6.15471 12.2705 6.34668L12.4883 6.46875C12.984 6.7728 13.3878 7.20854 13.6533 7.72949L13.7197 7.87207C13.8642 8.20859 13.9292 8.56974 13.9619 8.9707C13.9987 9.42092 13.998 9.97799 13.998 10.667V12.665ZM18.165 9.33301C18.165 10.022 18.1657 10.5791 18.1289 11.0293C18.0961 11.4302 18.0311 11.7914 17.8867 12.1279L17.8203 12.2705C17.5549 12.7914 17.1509 13.2272 16.6553 13.5313L16.4365 13.6533C16.0599 13.8452 15.6541 13.9245 15.1963 13.9619C14.8593 13.9895 14.4624 13.9935 13.9951 13.9951C13.9935 14.4624 13.9895 14.8593 13.9619 15.1963C13.9292 15.597 13.864 15.9576 13.7197 16.2939L13.6533 16.4365C13.3878 16.9576 12.9841 17.3941 12.4883 17.6982L12.2705 17.8203C11.8937 18.0123 11.4873 18.0915 11.0293 18.1289C10.5791 18.1657 10.022 18.165 9.33301 18.165H6.5C5.81091 18.165 5.25395 18.1657 4.80371 18.1289C4.40306 18.0962 4.04235 18.031 3.70606 17.8867L3.56348 17.8203C3.04244 17.5548 2.60585 17.151 2.30176 16.6553L2.17969 16.4365C1.98788 16.0599 1.90851 15.6541 1.87109 15.1963C1.83431 14.746 1.83496 14.1891 1.83496 13.5V10.667C1.83496 9.978 1.83432 9.42091 1.87109 8.9707C1.90851 8.5127 1.98772 8.10625 2.17969 7.72949L2.30176 7.51172C2.60586 7.0159 3.04236 6.6122 3.56348 6.34668L3.70606 6.28027C4.04237 6.136 4.40303 6.07083 4.80371 6.03809C5.14051 6.01057 5.53708 6.00551 6.00391 6.00391C6.00551 5.53708 6.01057 5.14051 6.03809 4.80371C6.0755 4.34588 6.15483 3.94012 6.34668 3.56348L6.46875 3.34473C6.77282 2.84912 7.20856 2.44514 7.72949 2.17969L7.87207 2.11328C8.20855 1.96886 8.56979 1.90385 8.9707 1.87109C9.42091 1.83432 9.978 1.83496 10.667 1.83496H13.5C14.1891 1.83496 14.746 1.83431 15.1963 1.87109C15.6541 1.90851 16.0599 1.98788 16.4365 2.17969L16.6553 2.30176C17.151 2.60585 17.5548 3.04244 17.8203 3.56348L17.8867 3.70606C18.031 4.04235 18.0962 4.40306 18.1289 4.80371C18.1657 5.25395 18.165 5.81091 18.165 6.5V9.33301Z"></path></svg>Copy</button><button><svg width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.0303 4.11328C13.4406 2.70317 15.7275 2.70305 17.1377 4.11328C18.5474 5.52355 18.5476 7.81057 17.1377 9.2207L10.8457 15.5117C10.522 15.8354 10.2868 16.0723 10.0547 16.2627L9.82031 16.4395C9.61539 16.5794 9.39783 16.7003 9.1709 16.7998L8.94141 16.8916C8.75976 16.9582 8.57206 17.0072 8.35547 17.0518L7.59082 17.1865L5.19727 17.5859C5.05455 17.6097 4.90286 17.6358 4.77441 17.6455C4.67576 17.653 4.54196 17.6555 4.39648 17.6201L4.24707 17.5703C4.02415 17.4746 3.84119 17.3068 3.72559 17.0957L3.67969 17.0029C3.59322 16.8013 3.59553 16.6073 3.60547 16.4756C3.61519 16.3473 3.6403 16.1963 3.66406 16.0537L4.06348 13.6602C4.1638 13.0582 4.22517 12.6732 4.3584 12.3096L4.45117 12.0791C4.55073 11.8521 4.67152 11.6346 4.81152 11.4297L4.9873 11.1953C5.17772 10.9632 5.4146 10.728 5.73828 10.4043L12.0303 4.11328ZM6.67871 11.3447C6.32926 11.6942 6.14542 11.8803 6.01953 12.0332L5.90918 12.1797C5.81574 12.3165 5.73539 12.4618 5.66895 12.6133L5.60742 12.7666C5.52668 12.9869 5.48332 13.229 5.375 13.8789L4.97656 16.2725L4.97559 16.2744H4.97852L7.37207 15.875L8.08887 15.749C8.25765 15.7147 8.37336 15.6839 8.4834 15.6436L8.63672 15.5811C8.78817 15.5146 8.93356 15.4342 9.07031 15.3408L9.2168 15.2305C9.36965 15.1046 9.55583 14.9207 9.90527 14.5713L14.8926 9.58301L11.666 6.35742L6.67871 11.3447ZM16.1963 5.05371C15.3054 4.16304 13.8616 4.16305 12.9707 5.05371L12.6074 5.41602L15.833 8.64258L16.1963 8.2793C17.0869 7.38845 17.0869 5.94456 16.1963 5.05371Z"></path><path d="M4.58301 1.7832C4.72589 1.7832 4.84877 1.88437 4.87695 2.02441C4.99384 2.60873 5.22432 3.11642 5.58398 3.50391C5.94115 3.88854 6.44253 4.172 7.13281 4.28711C7.27713 4.3114 7.38267 4.43665 7.38281 4.58301C7.38281 4.7295 7.27723 4.8546 7.13281 4.87891C6.44249 4.99401 5.94116 5.27746 5.58398 5.66211C5.26908 6.00126 5.05404 6.43267 4.92676 6.92676L4.87695 7.1416C4.84891 7.28183 4.72601 7.38281 4.58301 7.38281C4.44013 7.38267 4.31709 7.28173 4.28906 7.1416C4.17212 6.55728 3.94179 6.04956 3.58203 5.66211C3.22483 5.27757 2.72347 4.99395 2.0332 4.87891C1.88897 4.85446 1.7832 4.72938 1.7832 4.58301C1.78335 4.43673 1.88902 4.3115 2.0332 4.28711C2.72366 4.17203 3.22481 3.88861 3.58203 3.50391C3.94186 3.11638 4.17214 2.60888 4.28906 2.02441L4.30371 1.97363C4.34801 1.86052 4.45804 1.78333 4.58301 1.7832Z"></path></svg>Edit</button></div></div></div><div><code>spark.sql(&quot;OPTIMIZE sales_data ZORDER BY (category)&quot;)
</code></div></div></pre>
<hr>
<p><strong>Partitioning Data</strong><br>Writes partitioned data to improve scan performance.</p>
<pre><div><div>python</div><div><div><div><button><svg width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.668 10.667C12.668 9.95614 12.668 9.46258 12.6367 9.0791C12.6137 8.79732 12.5758 8.60761 12.5244 8.46387L12.4688 8.33399C12.3148 8.03193 12.0803 7.77885 11.793 7.60254L11.666 7.53125C11.508 7.45087 11.2963 7.39395 10.9209 7.36328C10.5374 7.33197 10.0439 7.33203 9.33301 7.33203H6.5C5.78896 7.33203 5.29563 7.33195 4.91211 7.36328C4.63016 7.38632 4.44065 7.42413 4.29688 7.47559L4.16699 7.53125C3.86488 7.68518 3.61186 7.9196 3.43555 8.20703L3.36524 8.33399C3.28478 8.49198 3.22795 8.70352 3.19727 9.0791C3.16595 9.46259 3.16504 9.95611 3.16504 10.667V13.5C3.16504 14.211 3.16593 14.7044 3.19727 15.0879C3.22797 15.4636 3.28473 15.675 3.36524 15.833L3.43555 15.959C3.61186 16.2466 3.86474 16.4807 4.16699 16.6348L4.29688 16.6914C4.44063 16.7428 4.63025 16.7797 4.91211 16.8027C5.29563 16.8341 5.78896 16.835 6.5 16.835H9.33301C10.0439 16.835 10.5374 16.8341 10.9209 16.8027C11.2965 16.772 11.508 16.7152 11.666 16.6348L11.793 16.5645C12.0804 16.3881 12.3148 16.1351 12.4688 15.833L12.5244 15.7031C12.5759 15.5594 12.6137 15.3698 12.6367 15.0879C12.6681 14.7044 12.668 14.211 12.668 13.5V10.667ZM13.998 12.665C14.4528 12.6634 14.8011 12.6602 15.0879 12.6367C15.4635 12.606 15.675 12.5492 15.833 12.4688L15.959 12.3975C16.2466 12.2211 16.4808 11.9682 16.6348 11.666L16.6914 11.5361C16.7428 11.3924 16.7797 11.2026 16.8027 10.9209C16.8341 10.5374 16.835 10.0439 16.835 9.33301V6.5C16.835 5.78896 16.8341 5.29563 16.8027 4.91211C16.7797 4.63025 16.7428 4.44063 16.6914 4.29688L16.6348 4.16699C16.4807 3.86474 16.2466 3.61186 15.959 3.43555L15.833 3.36524C15.675 3.28473 15.4636 3.22797 15.0879 3.19727C14.7044 3.16593 14.211 3.16504 13.5 3.16504H10.667C9.9561 3.16504 9.46259 3.16595 9.0791 3.19727C8.79739 3.22028 8.6076 3.2572 8.46387 3.30859L8.33399 3.36524C8.03176 3.51923 7.77886 3.75343 7.60254 4.04102L7.53125 4.16699C7.4508 4.32498 7.39397 4.53655 7.36328 4.91211C7.33985 5.19893 7.33562 5.54719 7.33399 6.00195H9.33301C10.022 6.00195 10.5791 6.00131 11.0293 6.03809C11.4873 6.07551 11.8937 6.15471 12.2705 6.34668L12.4883 6.46875C12.984 6.7728 13.3878 7.20854 13.6533 7.72949L13.7197 7.87207C13.8642 8.20859 13.9292 8.56974 13.9619 8.9707C13.9987 9.42092 13.998 9.97799 13.998 10.667V12.665ZM18.165 9.33301C18.165 10.022 18.1657 10.5791 18.1289 11.0293C18.0961 11.4302 18.0311 11.7914 17.8867 12.1279L17.8203 12.2705C17.5549 12.7914 17.1509 13.2272 16.6553 13.5313L16.4365 13.6533C16.0599 13.8452 15.6541 13.9245 15.1963 13.9619C14.8593 13.9895 14.4624 13.9935 13.9951 13.9951C13.9935 14.4624 13.9895 14.8593 13.9619 15.1963C13.9292 15.597 13.864 15.9576 13.7197 16.2939L13.6533 16.4365C13.3878 16.9576 12.9841 17.3941 12.4883 17.6982L12.2705 17.8203C11.8937 18.0123 11.4873 18.0915 11.0293 18.1289C10.5791 18.1657 10.022 18.165 9.33301 18.165H6.5C5.81091 18.165 5.25395 18.1657 4.80371 18.1289C4.40306 18.0962 4.04235 18.031 3.70606 17.8867L3.56348 17.8203C3.04244 17.5548 2.60585 17.151 2.30176 16.6553L2.17969 16.4365C1.98788 16.0599 1.90851 15.6541 1.87109 15.1963C1.83431 14.746 1.83496 14.1891 1.83496 13.5V10.667C1.83496 9.978 1.83432 9.42091 1.87109 8.9707C1.90851 8.5127 1.98772 8.10625 2.17969 7.72949L2.30176 7.51172C2.60586 7.0159 3.04236 6.6122 3.56348 6.34668L3.70606 6.28027C4.04237 6.136 4.40303 6.07083 4.80371 6.03809C5.14051 6.01057 5.53708 6.00551 6.00391 6.00391C6.00551 5.53708 6.01057 5.14051 6.03809 4.80371C6.0755 4.34588 6.15483 3.94012 6.34668 3.56348L6.46875 3.34473C6.77282 2.84912 7.20856 2.44514 7.72949 2.17969L7.87207 2.11328C8.20855 1.96886 8.56979 1.90385 8.9707 1.87109C9.42091 1.83432 9.978 1.83496 10.667 1.83496H13.5C14.1891 1.83496 14.746 1.83431 15.1963 1.87109C15.6541 1.90851 16.0599 1.98788 16.4365 2.17969L16.6553 2.30176C17.151 2.60585 17.5548 3.04244 17.8203 3.56348L17.8867 3.70606C18.031 4.04235 18.0962 4.40306 18.1289 4.80371C18.1657 5.25395 18.165 5.81091 18.165 6.5V9.33301Z"></path></svg>Copy</button><button><svg width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.0303 4.11328C13.4406 2.70317 15.7275 2.70305 17.1377 4.11328C18.5474 5.52355 18.5476 7.81057 17.1377 9.2207L10.8457 15.5117C10.522 15.8354 10.2868 16.0723 10.0547 16.2627L9.82031 16.4395C9.61539 16.5794 9.39783 16.7003 9.1709 16.7998L8.94141 16.8916C8.75976 16.9582 8.57206 17.0072 8.35547 17.0518L7.59082 17.1865L5.19727 17.5859C5.05455 17.6097 4.90286 17.6358 4.77441 17.6455C4.67576 17.653 4.54196 17.6555 4.39648 17.6201L4.24707 17.5703C4.02415 17.4746 3.84119 17.3068 3.72559 17.0957L3.67969 17.0029C3.59322 16.8013 3.59553 16.6073 3.60547 16.4756C3.61519 16.3473 3.6403 16.1963 3.66406 16.0537L4.06348 13.6602C4.1638 13.0582 4.22517 12.6732 4.3584 12.3096L4.45117 12.0791C4.55073 11.8521 4.67152 11.6346 4.81152 11.4297L4.9873 11.1953C5.17772 10.9632 5.4146 10.728 5.73828 10.4043L12.0303 4.11328ZM6.67871 11.3447C6.32926 11.6942 6.14542 11.8803 6.01953 12.0332L5.90918 12.1797C5.81574 12.3165 5.73539 12.4618 5.66895 12.6133L5.60742 12.7666C5.52668 12.9869 5.48332 13.229 5.375 13.8789L4.97656 16.2725L4.97559 16.2744H4.97852L7.37207 15.875L8.08887 15.749C8.25765 15.7147 8.37336 15.6839 8.4834 15.6436L8.63672 15.5811C8.78817 15.5146 8.93356 15.4342 9.07031 15.3408L9.2168 15.2305C9.36965 15.1046 9.55583 14.9207 9.90527 14.5713L14.8926 9.58301L11.666 6.35742L6.67871 11.3447ZM16.1963 5.05371C15.3054 4.16304 13.8616 4.16305 12.9707 5.05371L12.6074 5.41602L15.833 8.64258L16.1963 8.2793C17.0869 7.38845 17.0869 5.94456 16.1963 5.05371Z"></path><path d="M4.58301 1.7832C4.72589 1.7832 4.84877 1.88437 4.87695 2.02441C4.99384 2.60873 5.22432 3.11642 5.58398 3.50391C5.94115 3.88854 6.44253 4.172 7.13281 4.28711C7.27713 4.3114 7.38267 4.43665 7.38281 4.58301C7.38281 4.7295 7.27723 4.8546 7.13281 4.87891C6.44249 4.99401 5.94116 5.27746 5.58398 5.66211C5.26908 6.00126 5.05404 6.43267 4.92676 6.92676L4.87695 7.1416C4.84891 7.28183 4.72601 7.38281 4.58301 7.38281C4.44013 7.38267 4.31709 7.28173 4.28906 7.1416C4.17212 6.55728 3.94179 6.04956 3.58203 5.66211C3.22483 5.27757 2.72347 4.99395 2.0332 4.87891C1.88897 4.85446 1.7832 4.72938 1.7832 4.58301C1.78335 4.43673 1.88902 4.3115 2.0332 4.28711C2.72366 4.17203 3.22481 3.88861 3.58203 3.50391C3.94186 3.11638 4.17214 2.60888 4.28906 2.02441L4.30371 1.97363C4.34801 1.86052 4.45804 1.78333 4.58301 1.7832Z"></path></svg>Edit</button></div></div></div><div><code>df.write.partitionBy(&quot;year&quot;, &quot;month&quot;) \
  .parquet(&quot;/mnt/data/sales_partitioned.parquet&quot;)
</code></div></div></pre>
<hr>
<h2><strong>7. Machine Learning with PySpark</strong></h2>
<p><strong>Training a Linear Regression Model</strong><br>Assembles features, fits a model, and prints the R&sup2; score.</p>
<pre><div><div>python</div><div><div><div><button><svg width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.668 10.667C12.668 9.95614 12.668 9.46258 12.6367 9.0791C12.6137 8.79732 12.5758 8.60761 12.5244 8.46387L12.4688 8.33399C12.3148 8.03193 12.0803 7.77885 11.793 7.60254L11.666 7.53125C11.508 7.45087 11.2963 7.39395 10.9209 7.36328C10.5374 7.33197 10.0439 7.33203 9.33301 7.33203H6.5C5.78896 7.33203 5.29563 7.33195 4.91211 7.36328C4.63016 7.38632 4.44065 7.42413 4.29688 7.47559L4.16699 7.53125C3.86488 7.68518 3.61186 7.9196 3.43555 8.20703L3.36524 8.33399C3.28478 8.49198 3.22795 8.70352 3.19727 9.0791C3.16595 9.46259 3.16504 9.95611 3.16504 10.667V13.5C3.16504 14.211 3.16593 14.7044 3.19727 15.0879C3.22797 15.4636 3.28473 15.675 3.36524 15.833L3.43555 15.959C3.61186 16.2466 3.86474 16.4807 4.16699 16.6348L4.29688 16.6914C4.44063 16.7428 4.63025 16.7797 4.91211 16.8027C5.29563 16.8341 5.78896 16.835 6.5 16.835H9.33301C10.0439 16.835 10.5374 16.8341 10.9209 16.8027C11.2965 16.772 11.508 16.7152 11.666 16.6348L11.793 16.5645C12.0804 16.3881 12.3148 16.1351 12.4688 15.833L12.5244 15.7031C12.5759 15.5594 12.6137 15.3698 12.6367 15.0879C12.6681 14.7044 12.668 14.211 12.668 13.5V10.667ZM13.998 12.665C14.4528 12.6634 14.8011 12.6602 15.0879 12.6367C15.4635 12.606 15.675 12.5492 15.833 12.4688L15.959 12.3975C16.2466 12.2211 16.4808 11.9682 16.6348 11.666L16.6914 11.5361C16.7428 11.3924 16.7797 11.2026 16.8027 10.9209C16.8341 10.5374 16.835 10.0439 16.835 9.33301V6.5C16.835 5.78896 16.8341 5.29563 16.8027 4.91211C16.7797 4.63025 16.7428 4.44063 16.6914 4.29688L16.6348 4.16699C16.4807 3.86474 16.2466 3.61186 15.959 3.43555L15.833 3.36524C15.675 3.28473 15.4636 3.22797 15.0879 3.19727C14.7044 3.16593 14.211 3.16504 13.5 3.16504H10.667C9.9561 3.16504 9.46259 3.16595 9.0791 3.19727C8.79739 3.22028 8.6076 3.2572 8.46387 3.30859L8.33399 3.36524C8.03176 3.51923 7.77886 3.75343 7.60254 4.04102L7.53125 4.16699C7.4508 4.32498 7.39397 4.53655 7.36328 4.91211C7.33985 5.19893 7.33562 5.54719 7.33399 6.00195H9.33301C10.022 6.00195 10.5791 6.00131 11.0293 6.03809C11.4873 6.07551 11.8937 6.15471 12.2705 6.34668L12.4883 6.46875C12.984 6.7728 13.3878 7.20854 13.6533 7.72949L13.7197 7.87207C13.8642 8.20859 13.9292 8.56974 13.9619 8.9707C13.9987 9.42092 13.998 9.97799 13.998 10.667V12.665ZM18.165 9.33301C18.165 10.022 18.1657 10.5791 18.1289 11.0293C18.0961 11.4302 18.0311 11.7914 17.8867 12.1279L17.8203 12.2705C17.5549 12.7914 17.1509 13.2272 16.6553 13.5313L16.4365 13.6533C16.0599 13.8452 15.6541 13.9245 15.1963 13.9619C14.8593 13.9895 14.4624 13.9935 13.9951 13.9951C13.9935 14.4624 13.9895 14.8593 13.9619 15.1963C13.9292 15.597 13.864 15.9576 13.7197 16.2939L13.6533 16.4365C13.3878 16.9576 12.9841 17.3941 12.4883 17.6982L12.2705 17.8203C11.8937 18.0123 11.4873 18.0915 11.0293 18.1289C10.5791 18.1657 10.022 18.165 9.33301 18.165H6.5C5.81091 18.165 5.25395 18.1657 4.80371 18.1289C4.40306 18.0962 4.04235 18.031 3.70606 17.8867L3.56348 17.8203C3.04244 17.5548 2.60585 17.151 2.30176 16.6553L2.17969 16.4365C1.98788 16.0599 1.90851 15.6541 1.87109 15.1963C1.83431 14.746 1.83496 14.1891 1.83496 13.5V10.667C1.83496 9.978 1.83432 9.42091 1.87109 8.9707C1.90851 8.5127 1.98772 8.10625 2.17969 7.72949L2.30176 7.51172C2.60586 7.0159 3.04236 6.6122 3.56348 6.34668L3.70606 6.28027C4.04237 6.136 4.40303 6.07083 4.80371 6.03809C5.14051 6.01057 5.53708 6.00551 6.00391 6.00391C6.00551 5.53708 6.01057 5.14051 6.03809 4.80371C6.0755 4.34588 6.15483 3.94012 6.34668 3.56348L6.46875 3.34473C6.77282 2.84912 7.20856 2.44514 7.72949 2.17969L7.87207 2.11328C8.20855 1.96886 8.56979 1.90385 8.9707 1.87109C9.42091 1.83432 9.978 1.83496 10.667 1.83496H13.5C14.1891 1.83496 14.746 1.83431 15.1963 1.87109C15.6541 1.90851 16.0599 1.98788 16.4365 2.17969L16.6553 2.30176C17.151 2.60585 17.5548 3.04244 17.8203 3.56348L17.8867 3.70606C18.031 4.04235 18.0962 4.40306 18.1289 4.80371C18.1657 5.25395 18.165 5.81091 18.165 6.5V9.33301Z"></path></svg>Copy</button><button><svg width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.0303 4.11328C13.4406 2.70317 15.7275 2.70305 17.1377 4.11328C18.5474 5.52355 18.5476 7.81057 17.1377 9.2207L10.8457 15.5117C10.522 15.8354 10.2868 16.0723 10.0547 16.2627L9.82031 16.4395C9.61539 16.5794 9.39783 16.7003 9.1709 16.7998L8.94141 16.8916C8.75976 16.9582 8.57206 17.0072 8.35547 17.0518L7.59082 17.1865L5.19727 17.5859C5.05455 17.6097 4.90286 17.6358 4.77441 17.6455C4.67576 17.653 4.54196 17.6555 4.39648 17.6201L4.24707 17.5703C4.02415 17.4746 3.84119 17.3068 3.72559 17.0957L3.67969 17.0029C3.59322 16.8013 3.59553 16.6073 3.60547 16.4756C3.61519 16.3473 3.6403 16.1963 3.66406 16.0537L4.06348 13.6602C4.1638 13.0582 4.22517 12.6732 4.3584 12.3096L4.45117 12.0791C4.55073 11.8521 4.67152 11.6346 4.81152 11.4297L4.9873 11.1953C5.17772 10.9632 5.4146 10.728 5.73828 10.4043L12.0303 4.11328ZM6.67871 11.3447C6.32926 11.6942 6.14542 11.8803 6.01953 12.0332L5.90918 12.1797C5.81574 12.3165 5.73539 12.4618 5.66895 12.6133L5.60742 12.7666C5.52668 12.9869 5.48332 13.229 5.375 13.8789L4.97656 16.2725L4.97559 16.2744H4.97852L7.37207 15.875L8.08887 15.749C8.25765 15.7147 8.37336 15.6839 8.4834 15.6436L8.63672 15.5811C8.78817 15.5146 8.93356 15.4342 9.07031 15.3408L9.2168 15.2305C9.36965 15.1046 9.55583 14.9207 9.90527 14.5713L14.8926 9.58301L11.666 6.35742L6.67871 11.3447ZM16.1963 5.05371C15.3054 4.16304 13.8616 4.16305 12.9707 5.05371L12.6074 5.41602L15.833 8.64258L16.1963 8.2793C17.0869 7.38845 17.0869 5.94456 16.1963 5.05371Z"></path><path d="M4.58301 1.7832C4.72589 1.7832 4.84877 1.88437 4.87695 2.02441C4.99384 2.60873 5.22432 3.11642 5.58398 3.50391C5.94115 3.88854 6.44253 4.172 7.13281 4.28711C7.27713 4.3114 7.38267 4.43665 7.38281 4.58301C7.38281 4.7295 7.27723 4.8546 7.13281 4.87891C6.44249 4.99401 5.94116 5.27746 5.58398 5.66211C5.26908 6.00126 5.05404 6.43267 4.92676 6.92676L4.87695 7.1416C4.84891 7.28183 4.72601 7.38281 4.58301 7.38281C4.44013 7.38267 4.31709 7.28173 4.28906 7.1416C4.17212 6.55728 3.94179 6.04956 3.58203 5.66211C3.22483 5.27757 2.72347 4.99395 2.0332 4.87891C1.88897 4.85446 1.7832 4.72938 1.7832 4.58301C1.78335 4.43673 1.88902 4.3115 2.0332 4.28711C2.72366 4.17203 3.22481 3.88861 3.58203 3.50391C3.94186 3.11638 4.17214 2.60888 4.28906 2.02441L4.30371 1.97363C4.34801 1.86052 4.45804 1.78333 4.58301 1.7832Z"></path></svg>Edit</button></div></div></div><div><code>from pyspark.ml.regression import LinearRegression
from pyspark.ml.feature import VectorAssembler

assembler = VectorAssembler(inputCols=[&quot;feature1&quot;, &quot;feature2&quot;], outputCol=&quot;features&quot;)
df = assembler.transform(df)

lr = LinearRegression(featuresCol=&quot;features&quot;, labelCol=&quot;target&quot;)
model = lr.fit(df)

print(model.summary.r2)
</code></div></div></pre>
<hr>
<p><strong>Applying a Pre-Trained Model</strong><br>Generates predictions on new data using the trained model.</p>
<pre><div><div>python</div><div><div><div><button><svg width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.668 10.667C12.668 9.95614 12.668 9.46258 12.6367 9.0791C12.6137 8.79732 12.5758 8.60761 12.5244 8.46387L12.4688 8.33399C12.3148 8.03193 12.0803 7.77885 11.793 7.60254L11.666 7.53125C11.508 7.45087 11.2963 7.39395 10.9209 7.36328C10.5374 7.33197 10.0439 7.33203 9.33301 7.33203H6.5C5.78896 7.33203 5.29563 7.33195 4.91211 7.36328C4.63016 7.38632 4.44065 7.42413 4.29688 7.47559L4.16699 7.53125C3.86488 7.68518 3.61186 7.9196 3.43555 8.20703L3.36524 8.33399C3.28478 8.49198 3.22795 8.70352 3.19727 9.0791C3.16595 9.46259 3.16504 9.95611 3.16504 10.667V13.5C3.16504 14.211 3.16593 14.7044 3.19727 15.0879C3.22797 15.4636 3.28473 15.675 3.36524 15.833L3.43555 15.959C3.61186 16.2466 3.86474 16.4807 4.16699 16.6348L4.29688 16.6914C4.44063 16.7428 4.63025 16.7797 4.91211 16.8027C5.29563 16.8341 5.78896 16.835 6.5 16.835H9.33301C10.0439 16.835 10.5374 16.8341 10.9209 16.8027C11.2965 16.772 11.508 16.7152 11.666 16.6348L11.793 16.5645C12.0804 16.3881 12.3148 16.1351 12.4688 15.833L12.5244 15.7031C12.5759 15.5594 12.6137 15.3698 12.6367 15.0879C12.6681 14.7044 12.668 14.211 12.668 13.5V10.667ZM13.998 12.665C14.4528 12.6634 14.8011 12.6602 15.0879 12.6367C15.4635 12.606 15.675 12.5492 15.833 12.4688L15.959 12.3975C16.2466 12.2211 16.4808 11.9682 16.6348 11.666L16.6914 11.5361C16.7428 11.3924 16.7797 11.2026 16.8027 10.9209C16.8341 10.5374 16.835 10.0439 16.835 9.33301V6.5C16.835 5.78896 16.8341 5.29563 16.8027 4.91211C16.7797 4.63025 16.7428 4.44063 16.6914 4.29688L16.6348 4.16699C16.4807 3.86474 16.2466 3.61186 15.959 3.43555L15.833 3.36524C15.675 3.28473 15.4636 3.22797 15.0879 3.19727C14.7044 3.16593 14.211 3.16504 13.5 3.16504H10.667C9.9561 3.16504 9.46259 3.16595 9.0791 3.19727C8.79739 3.22028 8.6076 3.2572 8.46387 3.30859L8.33399 3.36524C8.03176 3.51923 7.77886 3.75343 7.60254 4.04102L7.53125 4.16699C7.4508 4.32498 7.39397 4.53655 7.36328 4.91211C7.33985 5.19893 7.33562 5.54719 7.33399 6.00195H9.33301C10.022 6.00195 10.5791 6.00131 11.0293 6.03809C11.4873 6.07551 11.8937 6.15471 12.2705 6.34668L12.4883 6.46875C12.984 6.7728 13.3878 7.20854 13.6533 7.72949L13.7197 7.87207C13.8642 8.20859 13.9292 8.56974 13.9619 8.9707C13.9987 9.42092 13.998 9.97799 13.998 10.667V12.665ZM18.165 9.33301C18.165 10.022 18.1657 10.5791 18.1289 11.0293C18.0961 11.4302 18.0311 11.7914 17.8867 12.1279L17.8203 12.2705C17.5549 12.7914 17.1509 13.2272 16.6553 13.5313L16.4365 13.6533C16.0599 13.8452 15.6541 13.9245 15.1963 13.9619C14.8593 13.9895 14.4624 13.9935 13.9951 13.9951C13.9935 14.4624 13.9895 14.8593 13.9619 15.1963C13.9292 15.597 13.864 15.9576 13.7197 16.2939L13.6533 16.4365C13.3878 16.9576 12.9841 17.3941 12.4883 17.6982L12.2705 17.8203C11.8937 18.0123 11.4873 18.0915 11.0293 18.1289C10.5791 18.1657 10.022 18.165 9.33301 18.165H6.5C5.81091 18.165 5.25395 18.1657 4.80371 18.1289C4.40306 18.0962 4.04235 18.031 3.70606 17.8867L3.56348 17.8203C3.04244 17.5548 2.60585 17.151 2.30176 16.6553L2.17969 16.4365C1.98788 16.0599 1.90851 15.6541 1.87109 15.1963C1.83431 14.746 1.83496 14.1891 1.83496 13.5V10.667C1.83496 9.978 1.83432 9.42091 1.87109 8.9707C1.90851 8.5127 1.98772 8.10625 2.17969 7.72949L2.30176 7.51172C2.60586 7.0159 3.04236 6.6122 3.56348 6.34668L3.70606 6.28027C4.04237 6.136 4.40303 6.07083 4.80371 6.03809C5.14051 6.01057 5.53708 6.00551 6.00391 6.00391C6.00551 5.53708 6.01057 5.14051 6.03809 4.80371C6.0755 4.34588 6.15483 3.94012 6.34668 3.56348L6.46875 3.34473C6.77282 2.84912 7.20856 2.44514 7.72949 2.17969L7.87207 2.11328C8.20855 1.96886 8.56979 1.90385 8.9707 1.87109C9.42091 1.83432 9.978 1.83496 10.667 1.83496H13.5C14.1891 1.83496 14.746 1.83431 15.1963 1.87109C15.6541 1.90851 16.0599 1.98788 16.4365 2.17969L16.6553 2.30176C17.151 2.60585 17.5548 3.04244 17.8203 3.56348L17.8867 3.70606C18.031 4.04235 18.0962 4.40306 18.1289 4.80371C18.1657 5.25395 18.165 5.81091 18.165 6.5V9.33301Z"></path></svg>Copy</button><button><svg width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12.0303 4.11328C13.4406 2.70317 15.7275 2.70305 17.1377 4.11328C18.5474 5.52355 18.5476 7.81057 17.1377 9.2207L10.8457 15.5117C10.522 15.8354 10.2868 16.0723 10.0547 16.2627L9.82031 16.4395C9.61539 16.5794 9.39783 16.7003 9.1709 16.7998L8.94141 16.8916C8.75976 16.9582 8.57206 17.0072 8.35547 17.0518L7.59082 17.1865L5.19727 17.5859C5.05455 17.6097 4.90286 17.6358 4.77441 17.6455C4.67576 17.653 4.54196 17.6555 4.39648 17.6201L4.24707 17.5703C4.02415 17.4746 3.84119 17.3068 3.72559 17.0957L3.67969 17.0029C3.59322 16.8013 3.59553 16.6073 3.60547 16.4756C3.61519 16.3473 3.6403 16.1963 3.66406 16.0537L4.06348 13.6602C4.1638 13.0582 4.22517 12.6732 4.3584 12.3096L4.45117 12.0791C4.55073 11.8521 4.67152 11.6346 4.81152 11.4297L4.9873 11.1953C5.17772 10.9632 5.4146 10.728 5.73828 10.4043L12.0303 4.11328ZM6.67871 11.3447C6.32926 11.6942 6.14542 11.8803 6.01953 12.0332L5.90918 12.1797C5.81574 12.3165 5.73539 12.4618 5.66895 12.6133L5.60742 12.7666C5.52668 12.9869 5.48332 13.229 5.375 13.8789L4.97656 16.2725L4.97559 16.2744H4.97852L7.37207 15.875L8.08887 15.749C8.25765 15.7147 8.37336 15.6839 8.4834 15.6436L8.63672 15.5811C8.78817 15.5146 8.93356 15.4342 9.07031 15.3408L9.2168 15.2305C9.36965 15.1046 9.55583 14.9207 9.90527 14.5713L14.8926 9.58301L11.666 6.35742L6.67871 11.3447ZM16.1963 5.05371C15.3054 4.16304 13.8616 4.16305 12.9707 5.05371L12.6074 5.41602L15.833 8.64258L16.1963 8.2793C17.0869 7.38845 17.0869 5.94456 16.1963 5.05371Z"></path><path d="M4.58301 1.7832C4.72589 1.7832 4.84877 1.88437 4.87695 2.02441C4.99384 2.60873 5.22432 3.11642 5.58398 3.50391C5.94115 3.88854 6.44253 4.172 7.13281 4.28711C7.27713 4.3114 7.38267 4.43665 7.38281 4.58301C7.38281 4.7295 7.27723 4.8546 7.13281 4.87891C6.44249 4.99401 5.94116 5.27746 5.58398 5.66211C5.26908 6.00126 5.05404 6.43267 4.92676 6.92676L4.87695 7.1416C4.84891 7.28183 4.72601 7.38281 4.58301 7.38281C4.44013 7.38267 4.31709 7.28173 4.28906 7.1416C4.17212 6.55728 3.94179 6.04956 3.58203 5.66211C3.22483 5.27757 2.72347 4.99395 2.0332 4.87891C1.88897 4.85446 1.7832 4.72938 1.7832 4.58301C1.78335 4.43673 1.88902 4.3115 2.0332 4.28711C2.72366 4.17203 3.22481 3.88861 3.58203 3.50391C3.94186 3.11638 4.17214 2.60888 4.28906 2.02441L4.30371 1.97363C4.34801 1.86052 4.45804 1.78333 4.58301 1.7832Z"></path></svg>Edit</button></div></div></div><div><code>predictions = model.transform(df)
predictions.select(&quot;features&quot;, &quot;prediction&quot;).show()</code></div></div></pre>
