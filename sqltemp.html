<hr data-start="229" data-end="232">
<h1 data-start="234" data-end="259"><strong data-start="236" data-end="259">SQL Query Templates</strong></h1>
<hr data-start="261" data-end="264">
<h2 data-start="266" data-end="304"><strong data-start="269" data-end="304">1. Basic Data Retrieval Queries</strong></h2>
<p data-start="306" data-end="375"><strong data-start="306" data-end="345"><span style="font-size: 18px;">1.1 Selecting All Data from a Table</span></strong><span style="font-size: 18px;"><br data-start="345" data-end="348"><code data-start="348" data-end="375">SELECT * FROM sales_data;</code></span></p>
<p data-start="377" data-end="479"><span style="font-size: 18px;"><strong data-start="377" data-end="411">1.2 Selecting Specific Columns</strong><br data-start="411" data-end="414"><code data-start="414" data-end="479">SELECT customer_id, product_name, sales_amount FROM sales_data;</code></span></p>
<p data-start="481" data-end="581"><span style="font-size: 18px;"><strong data-start="481" data-end="526">1.3 Filtering Data Using the WHERE Clause</strong><br data-start="526" data-end="529"><code data-start="529" data-end="581">SELECT * FROM sales_data WHERE sales_amount &gt; 100;</code></span></p>
<p data-start="583" data-end="750"><span style="font-size: 18px;"><strong data-start="583" data-end="637">1.4 Sorting Data in Ascending and Descending Order</strong><br data-start="637" data-end="640"><code data-start="640" data-end="694">SELECT * FROM sales_data ORDER BY sales_amount DESC;</code><br data-start="694" data-end="697"><code data-start="697" data-end="750">SELECT * FROM sales_data ORDER BY sales_amount ASC;</code></span></p>
<p data-start="752" data-end="821"><span style="font-size: 18px;"><strong data-start="752" data-end="782">1.5 Limiting Query Results</strong><br data-start="782" data-end="785"></span><code data-start="785" data-end="821"><span style="font-size: 18px;">SELECT * FROM sales_data LIMIT 10;</span></code></p>
<hr data-start="823" data-end="826">
<h2 data-start="828" data-end="867"><strong data-start="831" data-end="867">2. Data Aggregation and Grouping</strong></h2>
<p data-start="869" data-end="1017"><strong data-start="869" data-end="912"><span style="font-size: 18px;">2.1 Calculating Total Sales Per Product</span></strong><span style="font-size: 18px;"><br data-start="912" data-end="915"><code data-start="915" data-end="1017">SELECT product_category, SUM(sales_amount) AS total_sales FROM sales_data GROUP BY product_category;</code></span></p>
<p data-start="1019" data-end="1207"><span style="font-size: 18px;"><strong data-start="1019" data-end="1076">2.2 Filtering Aggregated Data Using the HAVING Clause</strong><br data-start="1076" data-end="1079"><code data-start="1079" data-end="1207">SELECT product_category, SUM(sales_amount) AS total_sales FROM sales_data GROUP BY product_category HAVING total_sales &gt; 1000;</code></span></p>
<p data-start="1209" data-end="1327"><span style="font-size: 18px;"><strong data-start="1209" data-end="1248">2.3 Counting Records in Each Region</strong><br data-start="1248" data-end="1251"></span><code data-start="1251" data-end="1327"><span style="font-size: 18px;">SELECT region, COUNT(*) AS total_customers FROM customers GROUP BY region;</span></code></p>
<hr data-start="1329" data-end="1332">
<h2 data-start="1334" data-end="1367"><strong data-start="1337" data-end="1367">3. Joins and Relationships</strong></h2>
<p data-start="1369" data-end="1534"><strong data-start="1369" data-end="1401"><span style="font-size: 18px;">3.1 Performing an Inner Join</span></strong><span style="font-size: 18px;"><br data-start="1401" data-end="1404"><code data-start="1404" data-end="1534">SELECT a.customer_id, a.sales_amount, b.customer_name FROM sales_data a INNER JOIN customers b ON a.customer_id = b.customer_id;</code></span></p>
<p data-start="1536" data-end="1698"><span style="font-size: 18px;"><strong data-start="1536" data-end="1566">3.2 Performing a Left Join</strong><br data-start="1566" data-end="1569"><code data-start="1569" data-end="1698">SELECT a.customer_id, a.sales_amount, b.customer_name FROM sales_data a LEFT JOIN customers b ON a.customer_id = b.customer_id;</code></span></p>
<p data-start="1700" data-end="1874"><span style="font-size: 18px;"><strong data-start="1700" data-end="1736">3.3 Performing a Full Outer Join</strong><br data-start="1736" data-end="1739"></span><code data-start="1739" data-end="1874"><span style="font-size: 18px;">SELECT a.customer_id, a.sales_amount, b.customer_name FROM sales_data a FULL OUTER JOIN customers b ON a.customer_id = b.customer_id;</span></code></p>
<hr data-start="1876" data-end="1879">
<h2 data-start="1881" data-end="1911"><strong data-start="1884" data-end="1911">4. Advanced SQL Queries</strong></h2>
<p data-start="1913" data-end="2133"><strong data-start="1913" data-end="1958"><span style="font-size: 18px;">4.1 Using Common Table Expressions (CTEs)</span></strong><span style="font-size: 18px;"><br data-start="1958" data-end="1961"><code data-start="1961" data-end="2133">WITH top_customers AS ( SELECT customer_id, SUM(sales_amount) AS total_spent FROM sales_data GROUP BY customer_id HAVING total_spent &gt; 5000 ) SELECT * FROM top_customers;</code></span></p>
<p data-start="2135" data-end="2325"><span style="font-size: 18px;"><strong data-start="2135" data-end="2195">4.2 Using Window Functions for Ranking and Row Numbering</strong><br data-start="2195" data-end="2198"><code data-start="2198" data-end="2325">SELECT customer_id, sales_amount, RANK() OVER (PARTITION BY region ORDER BY sales_amount DESC) AS sales_rank FROM sales_data;</code></span></p>
<p data-start="2327" data-end="2561"><span style="font-size: 18px;"><strong data-start="2327" data-end="2378">4.3 Using CASE Statements for Conditional Logic</strong><br data-start="2378" data-end="2381"></span><code data-start="2381" data-end="2561"><span style="font-size: 18px;">SELECT customer_id, sales_amount, CASE WHEN sales_amount &gt; 1000 THEN &apos;High&apos; WHEN sales_amount BETWEEN 500 AND 1000 THEN &apos;Medium&apos; ELSE &apos;Low&apos; END AS sales_category FROM sales_data;</span></code></p>
<hr data-start="2563" data-end="2566">
<h2 data-start="2568" data-end="2610"><strong data-start="2571" data-end="2610">5. Performance Optimization Queries</strong></h2>
<p data-start="2612" data-end="2700"><strong data-start="2612" data-end="2652"><span style="font-size: 18px;">5.1 Optimizing Table with Z-Ordering</span></strong><span style="font-size: 18px;"><br data-start="2652" data-end="2655"><code data-start="2655" data-end="2700">OPTIMIZE sales_data ZORDER BY (sales_date);</code></span></p>
<p data-start="2702" data-end="2768"><span style="font-size: 18px;"><strong data-start="2702" data-end="2740">5.2 Caching Frequently Used Tables</strong><br data-start="2740" data-end="2743"><code data-start="2743" data-end="2768">CACHE TABLE sales_data;</code></span></p>
<p data-start="2770" data-end="2879"><span style="font-size: 18px;"><strong data-start="2770" data-end="2806">5.3 Viewing Query Execution Plan</strong><br data-start="2806" data-end="2809"></span><code data-start="2809" data-end="2879"><span style="font-size: 18px;">EXPLAIN FORMATTED SELECT * FROM sales_data WHERE sales_amount &gt; 500;</span></code></p>
<hr data-start="2881" data-end="2884">
<h2 data-start="2886" data-end="2923"><strong data-start="2889" data-end="2923">6. Security and Access Control</strong></h2>
<p data-start="2925" data-end="3020"><strong data-start="2925" data-end="2963"><span style="font-size: 18px;">6.1 Granting Read Access to a User</span></strong><span style="font-size: 18px;"><br data-start="2963" data-end="2966"><code data-start="2966" data-end="3020">GRANT SELECT ON TABLE sales_data TO USER &apos;john_doe&apos;;</code></span></p>
<p data-start="3022" data-end="3117"><span style="font-size: 18px;"><strong data-start="3022" data-end="3057">6.2 Revoking Access from a User</strong><br data-start="3057" data-end="3060"><code data-start="3060" data-end="3117">REVOKE SELECT ON TABLE sales_data FROM USER &apos;john_doe&apos;;</code></span></p>
<p data-start="3119" data-end="3249"><span style="font-size: 18px;"><strong data-start="3119" data-end="3161">6.3 Auditing SQL Queries in Databricks</strong><br data-start="3161" data-end="3164"><code data-start="3164" data-end="3249">SELECT * FROM system.information_schema.query_history WHERE user_name = &apos;john_doe&apos;;</code></span></p>
<hr data-start="3251" data-end="3254">
<h2 data-start="3256" data-end="3299"><strong data-start="3259" data-end="3299">7. Automating Queries with Workflows</strong></h2>
<p data-start="3301" data-end="3483"><strong data-start="3301" data-end="3358"><span style="font-size: 18px;">7.1 Creating a Scheduled Job to Summarize Daily Sales</span></strong><span style="font-size: 18px;"><br data-start="3358" data-end="3361"><code data-start="3361" data-end="3483">INSERT INTO daily_sales_summary SELECT sales_date, SUM(sales_amount) AS total_sales FROM sales_data GROUP BY sales_date;</code></span></p>
<p data-start="3485" data-end="3598"><span style="font-size: 18px;"><strong data-start="3485" data-end="3532">7.2 Running Queries Based on Event Triggers</strong><br data-start="3532" data-end="3535"><code data-start="3535" data-end="3598">SELECT * FROM sales_data WHERE sales_date = CURRENT_DATE - 1;</code></span></p>
<p data-start="3600" data-end="3855"><span style="font-size: 18px;"><strong data-start="3600" data-end="3647">7.3 Incremental Data Processing Using MERGE</strong><br data-start="3647" data-end="3650"></span><code data-start="3650" data-end="3855"><span style="font-size: 18px;">MERGE INTO sales_delta AS target USING new_sales_data AS source ON target.sales_id = source.sales_id WHEN MATCHED THEN UPDATE SET target.sales_amount = source.sales_amount WHEN NOT MATCHED THEN INSERT *;</span></code></p>
<hr data-start="3857" data-end="3860">
<h2 data-start="3862" data-end="3910"><strong data-start="3865" data-end="3910">8. Data Governance and Compliance Queries</strong></h2>
<p data-start="3912" data-end="3972"><strong data-start="3912" data-end="3940"><span style="font-size: 18px;">8.1 Viewing Table Schema</span></strong><span style="font-size: 18px;"><br data-start="3940" data-end="3943"><code data-start="3943" data-end="3972">DESCRIBE DETAIL sales_data;</code></span></p>
<p data-start="3974" data-end="4103"><span style="font-size: 18px;"><strong data-start="3974" data-end="4012">8.2 Checking for Duplicate Records</strong><br data-start="4012" data-end="4015"><code data-start="4015" data-end="4103">SELECT customer_id, COUNT(*) FROM sales_data GROUP BY customer_id HAVING COUNT(*) &gt; 1;</code></span></p>
<p data-start="4105" data-end="4243"><span style="font-size: 18px;"><strong data-start="4105" data-end="4144">8.3 Implementing Row-Level Security</strong><br data-start="4144" data-end="4147"></span><code data-start="4147" data-end="4243"><span style="font-size: 18px;">CREATE VIEW restricted_sales AS SELECT * FROM sales_data WHERE region = CURRENT_USER_REGION();</span></code></p>
